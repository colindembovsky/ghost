<?xml version="1.0" encoding="utf-8"?>
<post>
  <id>4b0d3491-425a-4610-b009-91c2bd27cc89</id>
  <title>TFS and Project Server Integration: Tips from the Trenches (Part 4)</title>
  <slug>tfs-and-project-server-integration-tips-from-the-trenches-(part-4)</slug>
  <shortUrl>http://bit.ly/1fxXf3M</shortUrl>
  <author>Colin Dembovsky</author>
  <pubDate>2011-07-07 13:17:00</pubDate>
  <lastModified>2020-04-08 19:14:45</lastModified>
  <content>&lt;h2&gt;Links to this series:&lt;/h2&gt; &lt;ul&gt; &lt;li&gt;&lt;a href="http://colinsalmcorner.blogspot.com/2011/07/tfs-and-project-server-integration-tips.html"&gt;Part 1 – Considerations&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="http://colinsalmcorner.blogspot.com/2011/07/tfs-and-project-server-integration-tips_07.html"&gt;Part 2 – Setup&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="http://colinsalmcorner.blogspot.com/2011/07/tfs-and-project-server-integration-tips_165.html"&gt;Part 3 – Configuration&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;h2&gt;Part 4: Synchronizing Hierarchies from TFS to Project&lt;/h2&gt; &lt;p&gt;One limitation of the synchronization is that you need to sync parent items before child items. One way of getting work items into TFS and Project is to use Excel. Open Excel, go to the Team Tab and click “New List”. In the dialogue, select the Team Project that is associated and select “Input List” to get some default columns. In the ribbon at the top, select “Choose Columns” and add “Project Server Submit” and “Project Server Enterprise Project”. Finally, press the “Add Tree Level” button to add a level for each level in your hierarchy.&lt;/p&gt; &lt;p&gt;Now you can enter your work items.&lt;/p&gt; &lt;p&gt;When you’re ready to submit to TFS, change the Project Server Submit value on &lt;strong&gt;only&lt;/strong&gt; the 1st level of the hierarchy to “Yes” and select the Enterprise Project in the Project Server Enterprise Project column (there will be a value here for each Enterprise Project that is associated to this Team Project). In the image below, you can see that I’ve only set the High Level Requirements to sync.&lt;/p&gt; &lt;p&gt;&lt;a href="http://lh5.ggpht.com/-DiUEKWlOL2M/ThWVlTpOusI/AAAAAAAAAR0/0ZQJtMJ9B3s/s1600-h/image9.png"&gt;&lt;img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto; padding-top: 0px" title="image" border="0" alt="image" src="http://lh3.ggpht.com/-m4sQKrnaa0w/ThWVmb8gZOI/AAAAAAAAAR4/OF99BnFSmEc/image_thumb5.png?imgmax=800" width="473" height="106"&gt;&lt;/a&gt;&lt;/p&gt; &lt;p&gt;Hit the Publish button in the ribbon to publish to TFS. The Integration engine will kick in and sync the high level items to Project Server. You can check this by waiting a short while (a minute or two) and then checking the history field of the work items that you’ve sync’d.&lt;/p&gt; &lt;h2&gt;TF285010: Not a valid Project Server Resource&lt;/h2&gt; &lt;p&gt;Often when you’re doing synchronization, you’ll come across this error message:&lt;/p&gt; &lt;p&gt;&lt;font face="Courier New"&gt;TF285010: The following user is not a valid Project Server resource: Colin Dembovsky. Add the Team Foundation user to the enterprise resource pool.&lt;/font&gt;&lt;/p&gt; &lt;p&gt;This is actually a generic error message (which could mean that the user is not an enterprise resource or has not been added to the resource pool for the Enterprise Project) or it could be a permissions issue. Check that the TFSService account (the integration identity) has the correct permissions.&lt;/p&gt; &lt;p&gt;&lt;strong&gt;You must also make sure that you publish the Enterprise Project&lt;/strong&gt;. Synchronization only works with published projects.&lt;/p&gt; &lt;p&gt;(Note: To get the sync engine to kick in again, I usually make a change to the title field of the work item).&lt;/p&gt; &lt;p&gt;Make sure you can see the following message in the history of the high level work items:&lt;/p&gt; &lt;p&gt;&lt;font face="Courier New"&gt;Project Server Sync: Successfully submitted the request to Project Server.&lt;/font&gt;&lt;/p&gt; &lt;h2&gt;Approvals&lt;/h2&gt; &lt;p&gt;So now the changes have been submitted to the Enterprise Project – if required, the Project Manager (or Timesheet approver) will need to approve the changes and publish the project.&lt;/p&gt; &lt;p&gt;&lt;a href="http://lh5.ggpht.com/-ZUC52YTDwG8/ThWVm3QksmI/AAAAAAAAAR8/b92ZitpkHNo/s1600-h/image19.png"&gt;&lt;img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto; padding-top: 0px" title="image" border="0" alt="image" src="http://lh6.ggpht.com/-qh_Umvrkooo/ThWVn-dFRPI/AAAAAAAAASA/Y1ZVK-KUicU/image_thumb11.png?imgmax=800" width="376" height="243"&gt;&lt;/a&gt;&lt;/p&gt; &lt;p&gt;If you log onto your PWA, you’ll see some task approvals waiting (in this case it’s a New Task Request). Approve the requests (you can preview if you want to and you can add comments when approving). Once you’ve approved the tasks, you’ll get &lt;strong&gt;approvals again&lt;/strong&gt;. This time there are “edits” to the tasks – hours worked, work item type and other fields. Again, you can preview if you want to – make sure you approve this 2nd approval!&lt;/p&gt; &lt;p&gt;Once you have approved the tasks (each one needs 2 approvals) you must &lt;strong&gt;publish the project&lt;/strong&gt;! Open it in Project Professional and select File-&gt;Publish. Once you’ve done that, you’ll be able to see the work items in the Project Plan:&lt;/p&gt; &lt;p&gt;&lt;a href="http://lh4.ggpht.com/-Hx7oQ9GDWnM/ThWVomY03LI/AAAAAAAAASE/z9Cc66V6A2M/s1600-h/image23.png"&gt;&lt;img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto; padding-top: 0px" title="image" border="0" alt="image" src="http://lh6.ggpht.com/-KDRvLb4CPK4/ThWVpUBLMII/AAAAAAAAASI/ph7MklEuKxM/image_thumb13.png?imgmax=800" width="401" height="153"&gt;&lt;/a&gt;&lt;/p&gt; &lt;p&gt;Now if you look at the history of Work Item in TFS, you’ll see a couple more edits from the sync engine. Note the approval that comes in (as well as the comment) &lt;strong&gt;are from the 2nd approval&lt;/strong&gt; on the PWA.&lt;/p&gt; &lt;h2&gt;Publishing the Next Level&lt;/h2&gt; &lt;p&gt;Now you can go back to your spreadsheet and change the Project Server Sync to yes on the next level of the hierarchy. I also added remaining work to the tasks at the same time. Once again, make sure you see the “Successfully submitted to Project Server” message in the history. Then do the double approval on the PWA and don’t forget to publish the plan!&lt;/p&gt; &lt;p&gt;You can also go ahead and enter predecessor information on the Project Plan to make sure that your resources are levelled and so on. Once you publish, you’ll see the changes (again the 2nd approval) on the work items in TFS. You’ll also notice the start dates coming in from the Project Plan as well as the padlock on the hierarchy – when you sync a hierarchy to Project Server, the links are locked within TFS. If you want to change the parenting, do it from the Project Plan.&lt;/p&gt; &lt;p&gt;&lt;a href="http://lh6.ggpht.com/-5euIUUkQIK8/ThWVqq6C8ZI/AAAAAAAAASM/F_aIaTF3lck/s1600-h/image27.png"&gt;&lt;img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto; padding-top: 0px" title="image" border="0" alt="image" src="http://lh4.ggpht.com/-LQW1p3l0-PQ/ThWVrb8F-pI/AAAAAAAAASQ/NfTVW_XhLcM/image_thumb15.png?imgmax=800" width="551" height="113"&gt;&lt;/a&gt;&lt;/p&gt;  </content>
  <ispublished>true</ispublished>
  <categories>
    <category>ALM</category>
  </categories>
  <comments>
    <comment isAdmin="false" isApproved="true" id="7c7ec913-e29a-4178-b579-334ed82b29bc">
      <author>Anonymous</author>
      <email>noreply@blogger.com</email>
      <website></website>
      <ip></ip>
      <userAgent></userAgent>
      <date>2011-08-10 07:7:24</date>
      <content>I get this error&lt;br /&gt;TF285010: The following user is not a valid Project Server resource: Colin Dembovsky. Add the Team Foundation user to the enterprise resource pool.&lt;br /&gt;&lt;br /&gt;Could you explain a bit further how to check your suggestion out?</content>
    </comment>
    <comment isAdmin="false" isApproved="true" id="92ff5c0b-3348-4884-897d-1c92e80ac4f1">
      <author>Colin Dembovsky</author>
      <email>noreply@blogger.com</email>
      <website>http://www.blogger.com/profile/02577890234096457646</website>
      <ip></ip>
      <userAgent></userAgent>
      <date>2011-08-15 21:45:38</date>
      <content>I'm not entirely sure what you mean by "check your suggestion out" - if you mean where do you see that message, you'll see it in the Work Item history field.&lt;br /&gt;&lt;br /&gt;As to the solution, you'll need to follow the suggestions in this post - check the permissions of the TFSService account, and make sure the Project Plan on Project Server is published (not just saved). Of course, you need to check that the user IS actually an enterprise resource on the Project Plan that you are trying to sync.</content>
    </comment>
    <comment isAdmin="false" isApproved="true" id="35175191-5127-4afc-9d20-2cc11b1842e3">
      <author>abby</author>
      <email>noreply@blogger.com</email>
      <website>http://www.blogger.com/profile/13913304532011635635</website>
      <ip></ip>
      <userAgent></userAgent>
      <date>2012-01-08 20:41:01</date>
      <content>Colin, this is very helpful. Can you suggest some resources (books) you use to better understand the intergration of tfs to server?</content>
    </comment>
  </comments>
  <viewCount>2242</viewCount>
</post>