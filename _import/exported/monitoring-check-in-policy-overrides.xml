<?xml version="1.0" encoding="utf-8"?>
<post>
  <id>fc147461-3e0f-44f6-bf5b-3eff0aa837f0</id>
  <title>Monitoring Check-in Policy Overrides</title>
  <slug>monitoring-check-in-policy-overrides</slug>
  <shortUrl>http://bit.ly/1iJcJl7</shortUrl>
  <author>Colin Dembovsky</author>
  <pubDate>2011-03-28 09:06:00</pubDate>
  <lastModified>2020-04-06 22:07:02</lastModified>
  <content>&lt;p&gt;I’m often asked by customers why there is no way to prevent check-in policy overrides in TFS. Usually I respond along the lines of, “Well, it should be a really rare occurrence (otherwise why have the policy?) and besides, every action against TFS is tracked, so you can monitor overrides and &lt;strike&gt;beat&lt;/strike&gt; ‘chat nicely’ to the developer who is overriding the policies”. Which is all well and fine, but exactly &lt;em&gt;how do you monitor policy overrides&lt;/em&gt;?&lt;/p&gt; &lt;p&gt;This weekend I checked Amazon to see if I could find &lt;a href="http://www.amazon.com/Professional-Team-Foundation-Server-ebook/dp/B004S82RRE/ref=sr_1_1?ie=UTF8&amp;m=AG56TWVU5XWC2&amp;s=books&amp;qid=1301295041&amp;sr=8-1" target="_blank"&gt;Professional Team Foundation Server 2010&lt;/a&gt; for my Kindle – and to my surprise, there it was! &lt;a href="http://www.edsquared.com/" target="_blank"&gt;Ed Blankenship&lt;/a&gt;, one of the authors, is a colleague at &lt;a href="http://www.notionsolutions.com/" target="_blank"&gt;Notion Solutions&lt;/a&gt; and is an absolute genius on all things TFS. The other authors are, of course, TFS legends too! I instantly purchased the book and while going through it, found a section in Chapter 7 that speaks about monitoring check-in policy overrides.&lt;/p&gt; &lt;p&gt;There are 2 main ways of doing so – via email alerts and via the warehouse.&lt;/p&gt; &lt;h2&gt;Email Notification&lt;/h2&gt; &lt;p&gt;Install the latest version of the &lt;a href="http://visualstudiogallery.msdn.microsoft.com/c255a1e4-04ba-4f68-8f4e-cd473d6b971f/" target="_blank"&gt;Team Foundation Power Tools&lt;/a&gt; – anyone using TFS should always have this installed! One of the features that gets installed with these tools is a richer notifications manger – the Alerts Explorer.&lt;/p&gt; &lt;p&gt;In VS, go to Team-&gt;Alerts Explorer and add a “Check-In to specific folder with policy overriden” alert (under the Check-in alerts section).&lt;/p&gt; &lt;p&gt;&lt;a href="http://lh6.ggpht.com/_d41Ixos7YsM/TZAzVMbFlkI/AAAAAAAAAQU/BltKpBs28gU/s1600-h/image%5B2%5D.png"&gt;&lt;img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; margin-left: auto; border-top: 0px; margin-right: auto; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://lh4.ggpht.com/_d41Ixos7YsM/TZAzWbl2ASI/AAAAAAAAAQY/Y4s1g_mtKPc/image_thumb.png?imgmax=800" width="221" height="244"&gt;&lt;/a&gt;&lt;/p&gt; &lt;p&gt;Now you’ll get an email whenever someone does something nefarious and overrides the check-in policy you’ve so meticulously planned and put in place…&lt;/p&gt; &lt;h2&gt;Monitoring via the Warehouse&lt;/h2&gt; &lt;p&gt;The second method of monitoring check-in overrides is to query the warehouse. In the warehouse database (called Tfs_Warehouse by default) there is a table called &lt;font face="Courier New"&gt;DimChangeset&lt;/font&gt;. One of the columns on this table is &lt;font face="Courier New"&gt;PolicyOverrideComment&lt;/font&gt;, which is null whenever there is no override and which contains the policy override comment (which is mandatory when overriding) otherwise. So you can easily craft a query (and turn it into a report) that looks for check-ins with a &lt;font face="Courier New"&gt;PolicyOverrideComment&lt;/font&gt;. Here’s the T-SQL:&lt;/p&gt;&lt;pre class="code"&gt;&lt;span style="color: blue"&gt;SELECT&lt;br /&gt;    &lt;/span&gt;&lt;span style="color: teal"&gt;[ChangesetSK]&lt;/span&gt;&lt;span style="color: gray"&gt;,&lt;br /&gt;    &lt;/span&gt;&lt;span style="color: teal"&gt;[ChangesetID]&lt;/span&gt;&lt;span style="color: gray"&gt;,&lt;br /&gt;    &lt;/span&gt;&lt;span style="color: teal"&gt;[ChangesetTitle]&lt;/span&gt;&lt;span style="color: gray"&gt;,&lt;br /&gt;    &lt;/span&gt;&lt;span style="color: teal"&gt;[PolicyOverrideComment]&lt;/span&gt;&lt;span style="color: gray"&gt;,&lt;br /&gt;    &lt;/span&gt;&lt;span style="color: teal"&gt;[LastUpdatedDateTime]&lt;/span&gt;&lt;span style="color: gray"&gt;,&lt;br /&gt;    &lt;/span&gt;&lt;span style="color: teal"&gt;[TeamProjectCollectionSK]&lt;/span&gt;&lt;span style="color: gray"&gt;,&lt;br /&gt;    &lt;/span&gt;&lt;span style="color: teal"&gt;[CheckedInBySK]&lt;br /&gt;&lt;/span&gt;&lt;span style="color: blue"&gt;FROM&lt;br /&gt;    &lt;/span&gt;&lt;span style="color: teal"&gt;[Tfs_Warehouse]&lt;/span&gt;&lt;span style="color: gray"&gt;.&lt;/span&gt;&lt;span style="color: teal"&gt;[dbo]&lt;/span&gt;&lt;span style="color: gray"&gt;.&lt;/span&gt;&lt;span style="color: teal"&gt;[DimChangeset]&lt;br /&gt;&lt;/span&gt;&lt;span style="color: blue"&gt;WHERE&lt;br /&gt;    &lt;/span&gt;&lt;span style="color: teal"&gt;[PolicyOverrideComment] &lt;/span&gt;&lt;span style="color: gray"&gt;IS NOT NULL&lt;br /&gt;&lt;/span&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;Happy monitoring!&lt;/p&gt;  </content>
  <ispublished>true</ispublished>
  <categories>
    <category>ALM</category>
  </categories>
  <comments></comments>
  <viewCount>3039</viewCount>
</post>